# 虛擬貨幣追蹤網站技術設計文件

## 系統架構

### 前端架構

- 採用 Next.js 14 應用路由器（App Router）架構
- 使用 React 19 建立用戶界面元件
- 使用 Shadcn UI 作為 UI 元件庫
- 使用 Tailwind CSS 進行樣式設計
- 採用 Recharts 實現簡約風格的圖表

### 資料流設計

- 服務端元件（Server Components）負責資料獲取，確保資料即時性並減輕客戶端負擔
- 客戶端元件（Client Components）處理互動功能如排序和圖表時間範圍切換
- 使用 Next.js 的資料獲取機制，結合快取策略優化 API 請求

## 資料獲取策略

### 幣安 API 整合

- 使用幣安公開 API 獲取市場資料
- 主要 API 端點：
  - `/api/v3/ticker/24hr`：獲取所有幣種 24 小時交易數據
  - `/api/v3/klines`：獲取 K 線數據用於歷史圖表
  - `/api/v3/exchangeInfo`：獲取交易對基本信息

### 資料處理邏輯

- 透過幣安 API 獲取原始數據
- 在服務端處理和過濾數據，只保留前 20 名幣種
- 計算台幣價格（根據當前匯率）
- 格式化數據以符合前端顯示需求

## 頁面結構與路由設計

### 應用路由

- 首頁（列表頁）：`/`
- 詳細頁：`/crypto/[symbol]`，其中`[symbol]`為幣種符號（如 BTC、ETH）

### 元件層次結構

- 共享元件：
  - `Header`：網站頂部導航
  - `PriceDisplay`：統一的價格顯示格式
  - `PercentageChange`：帶顏色的百分比變化顯示
- 列表頁元件：
  - `CryptoTable`：虛擬貨幣列表表格
  - `SortableHeader`：可排序的表頭
- 詳細頁元件：
  - `CryptoHeader`：幣種基本信息顯示
  - `PriceChart`：價格歷史圖表
  - `TimeRangeSelector`：時間範圍選擇器
  - `MarketInfoCard`：市場信息卡片

## 狀態管理

- 使用 React 的 useState 和 useReducer 管理本地 UI 狀態
- 使用 Server Components 處理大部分數據請求，減少客戶端狀態管理複雜性
- 使用 URL 參數保存部分 UI 狀態（如詳細頁的時間範圍選擇）

## 圖表實現

- 使用 Recharts 實現簡約風格的價格歷史圖表
- 圖表類型：面積圖結合折線圖
- 支援懸停顯示詳細數據
- 標記重要點位（最高價、最低價）
- 根據價格變動使用不同顏色（上漲綠色，下跌紅色）

## 響應式設計

- 使用 Tailwind CSS 的響應式類設計不同螢幕尺寸的布局
- 在移動裝置上，列表頁採用卡片式布局替代表格
- 詳細頁在小螢幕上調整元件排列，確保良好的用戶體驗

## 效能優化

- 實現圖像懶加載
- 在服務端進行 API 數據過濾，減少傳輸數據量
- 使用 Next.js 的 ISR（增量靜態再生成）策略刷新數據
- 實現適當的快取策略，避免頻繁 API 請求

## 錯誤處理

- 實現全局錯誤處理邊界
- API 請求失敗時提供優雅的後備 UI
- 實現資料載入狀態顯示
- 處理無網絡連接情況下的用戶體驗
